<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>로또 번호 추첨기</title>
  <style>
    :root { --gap: 10px; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
    .toolbar { display: flex; gap: var(--gap); align-items: center; flex-wrap: wrap; }
    .results { margin-top: 16px; display: flex; flex-wrap: wrap; gap: var(--gap); }
    .ticket { display: flex; align-items: center; gap: 8px; padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 12px; }
    .badge { font-size: 12px; }
    .nums { display: flex; gap: 6px; flex-wrap: wrap; }
    .ball {
      width: 34px; height: 34px; border-radius: 50%; display: grid; place-items: center;
      border: 1px solid #e5e7eb; font-weight: 600; background: #fff;
    }
    .small { color: #6b7280; font-size: 12px; }
    button, select { padding: 8px 12px; border-radius: 10px; border: 1px solid #d1d5db; background: #fff; cursor: pointer; }
    button.primary { background: #111827; color: #fff; border-color: #111827; }
    button:disabled { opacity: .6; cursor: not-allowed; }
  </style>
</head>
<body>
  <h1>로또 번호 추첨기</h1>
  <div class="toolbar" role="group" aria-label="로또 추첨 컨트롤">
    <label for="count">몇 개 추첨할까요? </label>
    <select id="count" aria-label="추첨 개수">
      <!-- 1 ~ 10 -->
    </select>
    <button id="draw" class="primary">뽑기</button>
    <button id="reset">초기화</button>
    <span id="total" class="small" aria-live="polite"></span>
  </div>

  <div class="results" id="results" aria-live="polite" aria-label="추첨 결과 목록"></div>

  <script>
    // --- 설정 (필요시 변경) ---
    const LOTTO_MIN = 1;           // 시작 숫자
    const LOTTO_MAX = 45;          // 끝 숫자 (한국 로또는 45)
    const PER_TICKET = 6;          // 한 장당 숫자 개수
    const FORMAT_TWO_DIGITS = true; // 1 -> 01 형식 표시 여부

    // select 옵션 채우기 (1~10)
    const countSelect = document.getElementById('count');
    for (let i = 1; i <= 10; i++) {
      const opt = document.createElement('option');
      opt.value = String(i);
      opt.textContent = `${i}개`;
      if (i === 5) opt.selected = true; // 기본값(선택)
      countSelect.appendChild(opt);
    }

    const drawBtn   = document.getElementById('draw');
    const resetBtn  = document.getElementById('reset');
    const resultsEl = document.getElementById('results');
    const totalEl   = document.getElementById('total');

    let totalTickets = 0;

    // 보안난수 기반 정수 (min~max)
    function randomInt(min, max) {
      // crypto가 있으면 사용
      if (window.crypto && window.crypto.getRandomValues) {
        const range = max - min + 1;
        const maxUint = 0xFFFFFFFF;
        const bucket = Math.floor(maxUint / range) * range;
        let x;
        const u32 = new Uint32Array(1);
        do {
          window.crypto.getRandomValues(u32);
          x = u32[0];
        } while (x >= bucket);
        return min + (x % range);
      }
      // 폴백
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // 한 장(6개) 생성: 중복 없이 오름차순 정렬
    function getRandomTicket() {
      const set = new Set();
      while (set.size < PER_TICKET) {
        set.add(randomInt(LOTTO_MIN, LOTTO_MAX));
      }
      return Array.from(set).sort((a, b) => a - b);
    }

    // 숫자 표시 포맷 (01, 02 …)
    function fmt(n) {
      return FORMAT_TWO_DIGITS ? String(n).padStart(2, '0') : String(n);
    }

    // 티켓 DOM 생성
    function renderTicket(nums) {
      const wrap = document.createElement('div');
      wrap.className = 'ticket';

      const idx = document.createElement('span');
      idx.className = 'badge';
      idx.textContent = `#${++totalTickets}`;

      const list = document.createElement('div');
      list.className = 'nums';

      nums.forEach(n => {
        const el = document.createElement('span');
        el.className = 'ball';
        el.textContent = fmt(n);
        list.appendChild(el);
      });

      wrap.appendChild(idx);
      wrap.appendChild(list);
      return wrap;
    }

    // “뽑기” 클릭 → 선택한 개수만큼 생성해서 결과에 누적 추가
    drawBtn.addEventListener('click', () => {
      const n = parseInt(countSelect.value, 10);
      drawBtn.disabled = true;
      try {
        const frag = document.createDocumentFragment();
        for (let i = 0; i < n; i++) {
          const ticket = getRandomTicket();
          frag.appendChild(renderTicket(ticket));
        }
        resultsEl.appendChild(frag);
        updateTotal();
      } finally {
        drawBtn.disabled = false;
      }
    });

    // “초기화” 클릭 → 결과 지우기
    resetBtn.addEventListener('click', () => {
      resultsEl.innerHTML = '';
      totalTickets = 0;
      updateTotal();
    });

    function updateTotal() {
      totalEl.textContent = totalTickets ? `총 ${totalTickets}장` : '';
    }
  </script>
</body>
</html>